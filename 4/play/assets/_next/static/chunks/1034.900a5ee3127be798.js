"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1034],{11034:function(e,t,a){a.r(t),a.d(t,{default:function(){return ek}});var i=a(85893),n=a(67294),o=a(81043),s=a(82492),l=a(21240),r=a(15431),d=a(85433),c=a(61610),p=a(77289),g={src:"/_next/static/media/ana-bg-mobile.f7137cb5.webp",height:99,width:102,blurDataURL:"data:image/webp;base64,UklGRqIAAABXRUJQVlA4WAoAAAAQAAAABwAABwAAQUxQSEEAAAAAACWo38x+DwAl7P305diyW6z//fTl2Myz8f/98+TYzLPw+vjv4tfMs63t7OXc1cyzNNTU0c3Lw60GmqampaSgkABWUDggOgAAAPABAJ0BKggACAACQDglqAJ0AR//3tfGQAD++H7WW0c5s1nLYTTrnD30Hsf35tZeV+Ec4R/eN4IAAAA=",blurWidth:8,blurHeight:8},h=a(42771),u={src:"/_next/static/media/bell.9adc53dc.gif",height:1500,width:1500,blurWidth:0,blurHeight:0},x=a(73935),A=a(94183),f=a(84502),m=a(41640),b=a(4374),y=a(27633),w={src:"/_next/static/media/ana_sparkle.bff35e20.svg",height:18,width:19,blurWidth:0,blurHeight:0},v=a(1857),S=a(40433),I=a(50678),j=a(68006),C=a(1393),k={src:"/_next/static/media/new-chat-btn.1d20db8a.svg",height:32,width:32,blurWidth:0,blurHeight:0},P={src:"/_next/static/media/send-button.664459f5.svg",height:32,width:32,blurWidth:0,blurHeight:0},B={src:"/_next/static/media/mute-notif.fba24246.webp",height:64,width:65,blurDataURL:"data:image/webp;base64,UklGRpIAAABXRUJQVlA4WAoAAAAQAAAABwAABwAAQUxQSEEAAAAAAAABZV8AVQEACXRHSZc3AABXFgA2UjMAAGUAIGQAZAAAZQ9yAwBkAAB1dQsAAHAAA6hdfH5ycwEpLQVnZAMAAABWUDggKgAAALABAJ0BKggACAACQDglpAAC52UfAOAA/v36nbxGydwQFFxXr8UNQAAAAA==",blurWidth:8,blurHeight:8},E=a(41203),_=a(6284),N=a(77621),Z=a(76097),R=a(12846),U=a(57833);let T=(0,U.F4)(["20%{background-position:0%   0%,50%  50%,100%  50%}40%{background-position:0% 100%,50%   0%,100%  50%}60%{background-position:0%  50%,50% 100%,100%   0%}80%{background-position:0%  50%,50%  50%,100% 100%}"]),W=(0,U.F4)(["0%{opacity:1;bottom:-100%;}95%{opacity:1;bottom:2px;}100%{opacity:1;bottom:2px;}"]),F=(0,U.F4)(["0%{bottom:2px;}100%{bottom:-100%;}"]);(0,U.F4)(["0%{opacity:0;bottom:-100%;}100%{opacity:1;bottom:2px;}"]);let L=(0,U.F4)(["0%{opacity:1;bottom:2px;}100%{opacity:0;bottom:-100%;}"]),H=U.ZP.div.withConfig({componentId:"sc-70526f39-0"})(["display:flex;width:316px;top:1%;right:32px;position:fixed;flex-direction:column;align-items:flex-start;justify-content:flex-end;gap:9px;border-radius:18px;border:1px solid #8C46FF;background:radial-gradient(61.12% 55.37% at 95.9% 97.64%,rgba(0,167,201,0.40) 0%,rgba(0,167,201,0.40) 100%),radial-gradient(57.17% 49.84% at 0% 66.39%,rgba(255,32,168,0.40) 0%,rgba(255,32,168,0.40) 100%),radial-gradient(54.88% 52.06% at 80.76% 25%,rgba(114,86,255,0.20) 0%,rgba(114,86,255,0.20) 100%),rgba(0,0,0,0.95);background:radial-gradient(61.12% 55.37% at 95.9% 97.64%,color(display-p3 0.0533 0.6424 0.7717 / 0.40) 0%,color(display-p3 0.0549 0.6431 0.7725 / 0.00) 100%),radial-gradient(57.17% 49.84% at 0% 66.39%,color(display-p3 1 0.2588 0.6471 / 0.40) 0%,color(display-p3 1 0.2588 0.6471 / 0.00) 100%),radial-gradient(54.88% 52.06% at 80.76% 25%,color(display-p3 0.4314 0.3412 0.9765 / 0.20) 0%,color(display-p3 0.4314 0.3412 0.9765 / 0.00) 100%),color(display-p3 0 0 0 / 0.95);backdrop-filter:blur(60px);opacity:0;z-index:1;"," .chat-bot-home-search &{@media (min-width:767px){min-height:350px;}}@media (max-width:1023px){right:2px;z-index:199;top:unset;}"," &.mobile-slide-up{opacity:0;animation-name:",";animation-duration:0.10s;animation-delay:0s;animation-fill-mode:forwards;}&.mobile-slide-down{opacity:1;bottom:2px;animation-name:",";animation-duration:0.4s;animation-fill-mode:forwards;}&.slide-up{opacity:1;&.nowbux-supported{top:50px;}}&.slide-down{opacity:1;bottom:2px;animation-name:",";animation-duration:0.4s;animation-fill-mode:forwards;}"],e=>{let{refreshBtnVisible:t}=e;return t&&(0,U.iv)(["right:78px;"])},e=>{let{isMobile:t}=e;return t&&(0,U.iv)(["right:2px;z-index:199;top:unset;"])},W,F,L),Q=U.ZP.div.withConfig({componentId:"sc-70526f39-1"})(["display:flex;flex-direction:column;align-items:flex-start;padding:0px 16px 16px 16px;gap:12px;align-self:stretch;margin-top:auto;"]),O=U.ZP.p.withConfig({componentId:"sc-70526f39-2"})(["display:flex;align-items:center;gap:4px;color:#fff;font-size:14px;font-weight:700;line-height:150%;width:100%;img{.ana-unmute{","}}"],(0,Z.gB)(R.ZP.t("anaUnmute"))),D=U.ZP.div.withConfig({componentId:"sc-70526f39-3"})(["border-bottom:1px solid rgba(255,255,255,0.1);width:100%;padding:12px 16px;.ana-header-icon{@media (max-width:1023px){bottom:0px;right:-20px;width:44px;height:44px;display:flex;justify-content:center;align-items:center;}@media (min-width:1024px){display:none;}}"]),z=U.ZP.div.withConfig({componentId:"sc-70526f39-4"})(["width:100%;display:flex;padding:12px 16px;flex-direction:column;align-items:flex-end;gap:16px;align-self:stretch;overflow:scroll;"]);U.ZP.div.withConfig({componentId:"sc-70526f39-5"})(["display:flex;justify-content:space-between;width:100%;button{&:hover{&:disabled{background:",";color:",";}}&:disabled{background:",";color:",";}}"],e=>{let{theme:t}=e;return t.colors.black10},e=>{let{theme:t}=e;return t.colors.white},e=>{let{theme:t}=e;return t.colors.black10},e=>{let{theme:t}=e;return t.colors.white}),U.ZP.div.withConfig({componentId:"sc-70526f39-6"})(["cursor:pointer;padding:5px;position:absolute;right:10px;top:12px;"]);let J=U.ZP.div.withConfig({componentId:"sc-70526f39-7"})(["display:flex;padding-bottom:",";justify-content:flex-end;gap:8px;align-self:stretch;"],e=>{let{theme:t}=e;return t.spacing.base4}),M=U.ZP.div.withConfig({componentId:"sc-70526f39-8"})(["display:flex;position:relative;max-width:350px;padding:10px 12px;flex-direction:column;align-items:flex-end;border-radius:16px 16px 0px 16px;border:1px solid rgba(255,255,255,0.00);border:1px solid color(display-p3 1 1 1 / 0.00);background:rgba(255,255,255,0.10);background:color(display-p3 1 1 1 / 0.10);gap:10px;&:after{content:'';position:absolute;bottom:-1px;right:-11px;width:10px;height:19px;background-image:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='19' viewBox='0 0 10 19' fill='none'%3E%3Cpath d='M0 19H10C5.40412 19 1.5557 15.5181 1.09726 10.9451L0 0V19Z' fill='white' fill-opacity='0.1' style='fill:white;fill-opacity:0.1;'/%3E%3C/svg%3E\");}"," p{overflow:hidden;text-overflow:ellipsis;color:",";margin:0;}"],v.iO,e=>{let{theme:t}=e;return t.colors.white70}),V=U.ZP.div.withConfig({componentId:"sc-70526f39-9"})(["min-height:auto;max-height:none;overflow-y:auto;display:flex;flex-direction:column;gap:8px;align-items:flex-end;"]);U.ZP.div.withConfig({componentId:"sc-70526f39-10"})(["width:30px;align-self:flex-start;aspect-ratio:2;--_g:no-repeat radial-gradient(circle closest-side,rgba(0,0,0,0.2) 90%,#0000);background:var(--_g) 0% 50%,var(--_g) 50% 50%,var(--_g) 100% 50%;background-size:calc(100% / 3) 50%;background-color:rgba(0,0,0,0.1);animation:",' 1s infinite linear;border-radius:6px;position:relative;&::before{content:"";position:absolute;top:15px;left:2px;border-top:5px solid rgba(0,0,0,0.1);border-left:5px solid transparent;border-right:5px solid transparent;}'],T);let G=U.ZP.span.withConfig({componentId:"sc-70526f39-11"})(["color:#fff;color:color(display-p3 1 1 1);font-size:14px;font-style:normal;font-weight:400;line-height:150%;"]);U.ZP.div.withConfig({componentId:"sc-70526f39-12"})(["display:flex;flex-wrap:wrap;gap:8px;"]);let q=U.ZP.div.withConfig({componentId:"sc-70526f39-13"})(["width:100%;display:flex;flex-direction:column;gap:4px;padding:10px;border-radius:12px;border:1px solid rgba(255,255,255,0.5);background:rgba(0,0,0,0.2);&:hover{border-radius:12px;border:1px solid rgba(255,255,255,0.70);background:rgba(0,0,0,0.20);box-shadow:0px 2px 8px 0px rgba(0,0,0,0.04);}&:focus{border:1px solid #FF00AB;}&:active:not(:disabled){border:1px solid #FF00AB;}box-shadow:0px 2px 8px 0px rgba(0,0,0,0.04);.send-chat-btn{height:32px;background:none;border:none;padding:0;cursor:pointer;&:focus{outline:none;}&:hover:not(:disabled){border-radius:6px;background:rgba(255,255,255,0.20);background:color(display-p3 1 1 1 / 0.20);box-shadow:0px 8px 16px 0px rgba(0,0,0,0.10);}&:active:not(:disabled){background-color:#FF42A5;}&:disabled{cursor:not-allowed;opacity:0.5;}}.new-chat-btn{position:relative;height:32px;background:none;border:none;padding:0;cursor:pointer;&:focus{outline:none;}&:hover{border-radius:6px;background:rgba(255,255,255,0.20);background:color(display-p3 1 1 1 / 0.20);box-shadow:0px 8px 16px 0px rgba(0,0,0,0.10);:after{opacity:1;visibility:visible;}}:after{content:attr(data-title);width:90px;position:absolute;top:20%;left:85%;margin-left:10px;padding:4px 6px;color:#fff;font-size:10px;text-align:center;opacity:0;visibility:hidden;transition:opacity 0.3s,visibility 0.3s;border-radius:4px;border:1px solid rgba(255,255,255,0.20);border:1px solid color(display-p3 1 1 1 / 0.20);background:rgba(0,0,0,0.80);}}img{cursor:pointer;}"]),Y=U.ZP.input.withConfig({componentId:"sc-70526f39-14"})(['background:none;border:none;flex-grow:1;outline:none;height:21px;color:#FFF;font-family:"Bricolage Grotesque";font-size:14px;font-style:normal;font-weight:400;line-height:150%;']),K=U.ZP.span.withConfig({componentId:"sc-70526f39-15"})(["color:rgba(255,255,255,0.70);color:color(display-p3 1 1 1 / 0.70);text-align:center;font-size:10px;font-style:normal;font-weight:400;line-height:normal;letter-spacing:0.2px;display:flex;justify-content:center;align-items:center;width:100%;"]),X=U.ZP.div.withConfig({componentId:"sc-70526f39-16"})(["position:relative;width:100%;height:40px;"]),$=U.ZP.div.withConfig({componentId:"sc-70526f39-17"})(["position:absolute;top:20px;left:2px;transform:translateY(-50%);width:24px;height:24px;overflow:hidden;border-radius:50%;"]),ee=U.ZP.video.withConfig({componentId:"sc-70526f39-18"})(["position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:50.09px;height:28.17px;object-fit:cover;"]),et=U.ZP.div.withConfig({componentId:"sc-70526f39-19"})(["position:absolute;top:0;left:0;width:100%;height:100%;background-image:",";background-size:cover;"],e=>"url(".concat(e.bgImg,")"));var ea={src:"/_next/static/media/ana-loader-mask.2277a64a.webp",height:1,width:1,blurDataURL:"data:image/webp;base64,UklGRkgAAABXRUJQVlA4WAoAAAAQAAAABwAABwAAQUxQSAkAAAABBxAREYiI/gcAVlA4IBgAAAAwAQCdASoIAAgAAkA4JaQAA3AA/vucwAA=",blurWidth:8,blurHeight:8},ei=()=>(0,i.jsx)(X,{children:(0,i.jsxs)($,{children:[(0,i.jsx)(ee,{autoPlay:!0,loop:!0,muted:!0,playsInline:!0,children:(0,i.jsx)("source",{src:p.LyI,type:"video/mp4"})}),(0,i.jsx)(et,{bgImg:(0,h.jW)(ea)})]})}),en=a(83530),eo=a(59949),es={src:"/_next/static/media/playnow-icon.a3dd66a4.svg",height:16,width:16,blurWidth:0,blurHeight:0},el={src:"/_next/static/media/ana-chat-icon.3100fe5e.webp",height:24,width:24,blurDataURL:"data:image/webp;base64,UklGRroAAABXRUJQVlA4WAoAAAAQAAAABwAABwAAQUxQSD4AAAABV6CQjSQ4ubv3qxzEYV1EBJZf5WcaqIkkKSowQXoZQlABCijCE8EngfwdxRH9D6nRKvgN5cN8sA4kBSchG1ZQOCBWAAAAEAIAnQEqCAAIAAJAOCWwAnQGKl5KwL5GAAD+q7MKV06u/x/4WuQT4T8hmH328m7tKBx4vDQ2N3YkcY5jk1zhm5avngOqPcaZY3PZN5s8F1cv0NZ3EAA=",blurWidth:8,blurHeight:8},er=a(75952),ed={src:"/_next/static/media/tenor_logo.07499b00.svg",height:16,width:44,blurWidth:0,blurHeight:0};let ec=U.ZP.div.withConfig({componentId:"sc-98654388-0"})(["display:flex;align-items:flex-end;gap:8px;align-self:stretch;"]),ep=U.ZP.div.withConfig({componentId:"sc-98654388-1"})(["display:flex;flex-direction:column;align-items:flex-start;flex:1 0 0;border-radius:16px 16px 16px 0px;border:1px solid rgba(255,255,255,0);background:linear-gradient(0deg,rgba(255,255,255,0.20) 0%,rgba(255,255,255,0.20) 100%),linear-gradient(270deg,rgba(255,255,255,0.05) 0%,rgba(255,255,255,0.05) 99.48%);"]),eg=U.ZP.div.withConfig({componentId:"sc-98654388-2"})(["padding:10px 16px;position:relative;&.show-caret{&:after{content:'';position:absolute;left:-10px;bottom:-1px;width:9px;height:19px;background-image:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='19' viewBox='0 0 10 19' fill='none'%3E%3Cpath d='M10 19H0C4.59588 19 8.4443 15.5181 8.90274 10.9451L10 0V19Z' fill='white' fill-opacity='0.2' style='fill:white;fill-opacity:0.2;'/%3E%3C/svg%3E\");}}"]),eh=U.ZP.div.withConfig({componentId:"sc-98654388-3"})(["display:flex;position:relative;padding:12px;align-items:flex-start;gap:10px;align-self:stretch;border-radius:0px 0px 16px 0px;border-top:1px solid rgba(255,255,255,0.1);background:linear-gradient(270deg,rgba(255,255,255,0.10) 0%,rgba(255,255,255,0.10) 99.48%);background:linear-gradient(270deg,color(display-p3 1 1 1 / 0.00) 0%,color(display-p3 1 1 1 / 0.00) 99.48%);&:last-child{border-radius:0px 0px 16px 0px;&:after{content:'';position:absolute;left:-10px;bottom:-1px;width:9px;height:19px;background-image:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='19' viewBox='0 0 10 19' fill='none'%3E%3Cpath d='M10 19H0C4.59588 19 8.4443 15.5181 8.90274 10.9451L10 0V19Z' fill='white' fill-opacity='0.2' style='fill:white;fill-opacity:0.2;'/%3E%3C/svg%3E\");}}"]),eu=U.ZP.p.withConfig({componentId:"sc-98654388-4"})(["color:rgba(255,255,255,0.70);font-size:12px;font-style:normal;font-weight:600;line-height:120%;"]),ex=U.ZP.div.withConfig({componentId:"sc-98654388-5"})(["position:relative;margin-left:40px;align-self:flex-start;.tenor-img{position:absolute;bottom:11px;left:9px;height:10px;}"]);var eA=e=>{let{content:t,ctaList:a,gifUrl:n}=e,{t:o}=(0,b.$)(),s="".concat(p.u1t,"placeholder-image.jpg");return(0,i.jsxs)(i.Fragment,{children:[n&&(0,i.jsxs)(ex,{children:[(0,i.jsx)("img",{src:n,alt:"",height:"200",style:{width:"100%"}}),(0,i.jsx)("img",{className:"tenor-img",src:(0,h.jW)(ed),alt:""})]}),(0,i.jsxs)(ec,{children:[(0,i.jsx)("img",{className:"ana-chat-img",style:{width:24,height:24},src:(0,h.jW)(el),alt:"ana bot icon"}),(0,i.jsxs)(ep,{children:[(0,i.jsx)(eg,{style:(null==a?void 0:a.length)?{}:{borderRadius:"20px 20px 20px 0px"},className:(null==a?void 0:a.length)?"":"show-caret",children:(0,i.jsx)(v.lU,{children:t})}),(null==a?void 0:a.length)>0&&a.map(e=>(0,i.jsxs)(eh,{children:[(0,i.jsx)("img",{style:{borderRadius:"12px"},src:e.ctaIconUrl||s,alt:"",width:60,height:60}),(0,i.jsxs)(eo.GN,{children:[(0,i.jsx)(eu,{children:e.ctaName}),(0,i.jsx)("a",{href:(0,er.ZP)(e.ctaUrl,"AnaChatBot"),target:"_self",style:{textDecoration:"none"},onClick:()=>(0,r.L9)("ChatBotPlayNowClicked",{packageName:e.packageName,chatSessionId:sessionStorage.getItem(p.FdJ)||"",element:e.element||"chatBox"}),children:(0,i.jsxs)(en.z,{variant:"primary",children:[(0,i.jsx)(v.IS,{children:o("playNow")}),(0,i.jsx)("img",{src:(0,h.jW)(es),alt:"",width:16})]})})]})]}))]})]})]})},ef=a(12499),em=function(e,t,a,i){return new(a||(a=Promise))(function(n,o){function s(e){try{r(i.next(e))}catch(e){o(e)}}function l(e){try{r(i.throw(e))}catch(e){o(e)}}function r(e){var t;e.done?n(e.value):((t=e.value)instanceof a?t:new a(function(e){e(t)})).then(s,l)}r((i=i.apply(e,t||[])).next())})},eb=e=>{let{onClose:t,wrapperRef:a,startSessionOnRender:d=!1,reaction:g}=e,{t:u}=(0,b.$)(),x=(0,n.useContext)(c.Z),[Z,R]=(0,n.useState)(null),[U,T]=(0,n.useState)(""),[W,F]=(0,n.useState)(""),[L,X]=(0,n.useState)(""),[$,ee]=(0,n.useState)([]),et=(0,o.I0)(),[ea,en]=(0,n.useState)(!1),eo=(0,n.useRef)(null),es=(0,o.v9)(e=>e.user.userMsgFromSearch),el=(0,o.v9)(e=>e.user.searchBarOpened),er=(0,o.v9)(e=>e.play.anaSpectatingGameplay),ed=(0,o.v9)(e=>e.play.muteAnaSpectateMessages),ec=(0,o.v9)(e=>e.play.aiSessionUpdateInProgress),ep=(0,o.v9)(e=>e.play.isAnnouncementBarVisible),eg=(0,o.v9)(e=>e.play.chatHistory),eh=(0,o.v9)(e=>e.auth.isLoggedIn),eu=x.isHomePage,ex=(0,n.useMemo)(()=>eg.length>1||!!$.length,[eg.length,$.length]);function eb(e){let t={uaId:(0,A.Fz)(p.nPo),uaSessionId:(0,A.io)(p.K3T),chatSessionId:sessionStorage.getItem(p.FdJ)||"",appId:x.appInfo.appId,content:e||U,feDeviceType:(0,A.zj)().feDeviceType,element:e?"searchBar":s.default.getState().play.isPlayerLoaded?"gamePlay":"chatBox",packageName:x.appInfo.packageName,gameName:x.appInfo.appName};return(0,A.c6)()&&s.default.getState().play.robloxExperienceId.toString()&&(t=Object.assign(Object.assign({},t),{robloxExperienceId:s.default.getState().play.robloxExperienceId.toString()})),m.ZP.updateAiChat({},t)}(0,n.useEffect)(()=>{es&&($.push({type:"human",content:es}),ee($),en(!0),eb(es).then(e=>{(e.status===f.VL.Success||e.status===f.VL.FailureRateLimitExceeded)&&(en(!1),$.push({type:"ai",content:e.botResponse}),ee($))}).catch(e=>{}),et({type:l.Z.SHOW_ANA_BOT,payload:{showAnaBot:!1}}),et({type:l.Z.UPDATE_USER_AND_DEVICE_DATA,payload:{userMsgFromSearch:""}}))},[es]),(0,n.useEffect)(()=>{F(""),!(0,A.tq)()||(0,A.Em)()||(0,A.zc)()?(0,A.Em)()||(0,A.zc)()?X("slide-up"):(0,A.nI)()&&X("slide-up"):X("mobile-slide-up");let e=eh?(0,I.et)():null;return e&&R(e),(0,r.L9)("ChatBotPopUpDisplayed",{chatSessionId:sessionStorage.getItem(p.FdJ)||""}),(eu||d||er)&&(0,A.U$)(),()=>{(0,A.U$)()}},[]),(0,n.useEffect)(()=>{eg.length>0||$.length>0?et({type:l.Z.SHOW_ANA_BOT,payload:{showAnaBot:!1}}):eu||et({type:l.Z.SHOW_ANA_BOT,payload:{showAnaBot:!0}});let e=eo.current;e&&(e.scrollTop=e.scrollHeight)},[JSON.stringify(eg),JSON.stringify($)]);let ey=()=>em(void 0,void 0,void 0,function*(){U&&!ea&&($.push({type:"human",content:U}),ee($),en(!0),eb().then(e=>{var t;(null===(t=e.botResponse)||void 0===t?void 0:t.answer)!==""&&(en(!1),$.push({type:"ai",content:e.botResponse}),ee($))}).catch(e=>{en(!1)}),et({type:l.Z.SHOW_ANA_BOT,payload:{showAnaBot:!1}}),T(""))}),ew=e=>{"Enter"===e.key&&ey()},ev=e=>e?JSON.parse(e.replace(/\\"/g,'"')):[];return(0,i.jsxs)(H,{ref:a,className:"\n        ".concat(L," ").concat(W,"\n        ").concat(ep?"nowbux-supported":"","\n      "),isMobile:!(0,A.nI)(),refreshBtnVisible:!(0,A.tq)()&&!(0,N.DJ)()&&(x.isAppPage||x.isPlayPage||!1),style:{height:ex?"calc(100% - ".concat(el&&(0,A.tq)()?"2%":(0,A.tq)()||(0,A.Em)()?"0%":el&&(0,A.tq)()?"100%":(0,A.nI)()?"10%":"110px",")"):"fit-content",justifyContent:"unset",borderRadius:"".concat(el||(0,A.tq)()&&ex?"0px":"18px")},children:[(0,i.jsx)(D,{children:(0,i.jsx)(S.Lb,{gap:"8",children:(0,i.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%"},children:(0,i.jsxs)(O,{style:eg.length>0||$.length>0?{margin:0}:{margin:window.screen.availWidth<1024?"8px 0px 0px 0px":"0px 0px 8px 0px"},children:[u("helloIAmAna"),(0,i.jsx)("div",{style:{flex:1},children:(0,i.jsx)("img",{src:(0,h.jW)(w),alt:"AnaSparkle",className:"ana-icon-sparkle",width:"18",height:"18"})}),er&&ed&&(0,i.jsx)(ef.a5,{className:"rounded unmute",style:{cursor:"pointer",marginRight:"4px"},onClick:()=>{et({type:y.Z.UPDATE_ANA_BOT_STATE,payload:{muteAnaSpectateMessages:!1}})},children:(0,i.jsx)("img",{src:(0,h.jW)(B),alt:"unmute",width:"18",height:"18"})}),(0,i.jsx)(ef.a5,{className:"close",onClick:()=>{!(0,A.tq)()||(0,A.Em)()||(0,A.zc)()?(0,A.Em)()||(0,A.zc)()?F("slide-down"):(0,A.nI)()&&F("slide-down"):F("mobile-slide-down"),setTimeout(()=>{t()},1500)},children:(0,i.jsx)(E.x,{style:{color:_.qm.colors.white70},size:16})})]})})})}),(0,i.jsxs)(z,{children:[(eg.length>0||$.length>0)&&(0,i.jsxs)(V,{ref:eo,children:[eg.length>0&&(0,i.jsx)(i.Fragment,{children:eg.map(e=>"human"===e.type?e.data.additional_kwargs.messageType&&"Image"===e.data.additional_kwargs.messageType?null:(0,i.jsxs)(J,{children:[(0,i.jsx)(M,{children:(0,i.jsx)(v.lU,{children:e.data.content})}),(0,i.jsx)(j.S1,{className:"chat-box-avatar",isLoggedIn:eh,children:(0,i.jsx)(C.Z,{id:"ng-profile",isLoggedIn:eh,user:Z,src:null==Z?void 0:Z.avatar,click:()=>{},size:24})})]}):(0,i.jsx)(eA,{content:e.data.content,gifUrl:e.data.additional_kwargs.gifUrl||"",ctaList:ev((null==e?void 0:e.data.additional_kwargs.cta)||"")}))}),$.length>0&&(0,i.jsx)(i.Fragment,{children:$.map(e=>{let{content:t,type:a}=e;return"human"===a?(0,i.jsxs)(J,{children:[(0,i.jsx)(M,{children:(0,i.jsx)(v.lU,{children:t})}),(0,i.jsx)(j.S1,{className:"chat-box-avatar",isLoggedIn:eh,children:(0,i.jsx)(C.Z,{id:"ng-profile",isLoggedIn:eh,user:Z,src:null==Z?void 0:Z.avatar,click:()=>{},size:24})})]}):(0,i.jsx)(eA,{gifUrl:(null==t?void 0:t.gifUrl)||"",content:null==t?void 0:t.answer,ctaList:null==t?void 0:t.ctaList})})}),ea&&(0,i.jsx)(ei,{})]}),0===eg.length&&0===$.length&&(0,i.jsx)(G,{children:u("anaGreetingText")})]}),(0,i.jsxs)(Q,{children:[(0,i.jsxs)(q,{children:[(0,i.jsx)(Y,{placeholder:"Ask me anything",value:U,onKeyUp:e=>e.stopPropagation(),onKeyDown:e=>e.stopPropagation(),onFocus:()=>em(void 0,void 0,void 0,function*(){0!==eg.length||0!==$.length||eu||(0,A.U$)()}),onChange:e=>T(e.target.value),onKeyPress:e=>ew(e)}),(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[($.length>0||eg.length>0)&&(0,i.jsx)("button",{"data-title":"Start New Chat",className:"new-chat-btn",onClick:()=>em(void 0,void 0,void 0,function*(){(0,r.L9)("ChatBotReset",{chatSessionId:sessionStorage.getItem(p.FdJ)||""}),eu||et({type:l.Z.SHOW_ANA_BOT,payload:{showAnaBot:!0}}),sessionStorage.removeItem(p.FdJ),et({type:y.Z.SET_CHAT_HISTORY,payload:{chatHistory:[]}}),ee([]),T(""),eu&&(0,A.U$)()}),children:(0,i.jsx)("img",{src:(0,h.jW)(k),alt:"new-chat-btn",height:"32",width:"32"})}),(0,i.jsx)("button",{style:{marginLeft:"auto"},className:"send-chat-btn",disabled:!U||ea||ec,onClick:()=>ey(),children:(0,i.jsx)("img",{src:(0,h.jW)(P),alt:"send-chat-btn",height:"32",width:"32"})})]})]}),(0,i.jsx)(K,{children:u("anaDisclaimer")})]})]})},ey={src:"/_next/static/media/messages.3f4b24fc.webp",height:96,width:97,blurDataURL:"data:image/webp;base64,UklGRqQAAABXRUJQVlA4WAoAAAAQAAAABwAABwAAQUxQSDoAAAABYBRJkqI6hhc6IAfMTC/0b+biPETEBPDrHtM0TYfVqABm0ahL5M9G0agARpFbHy+WuveZplpEPPkCVlA4IEQAAACQAQCdASoIAAgAAkA4JaQAAp0gc4AA4n65RdMl5BZxGaNLYWNR6z7dgLV8YrXATHtY9Ok8JtbAL1kHYK8X9gmvOOAAAA==",blurWidth:8,blurHeight:8},ew={src:"/_next/static/media/tick.26c97726.webp",height:64,width:64,blurDataURL:"data:image/webp;base64,UklGRmoAAABXRUJQVlA4WAoAAAAQAAAABwAABwAAQUxQSCwAAAABYFNbW5tHX1HG1A0ggIOAlC1r1sitEiJiAngvwt2Y4KEvAq7YDgW4/bT8CVZQOCAYAAAAMAEAnQEqCAAIAAJAOCWkAANwAP77IYAA",blurWidth:8,blurHeight:8},ev=e=>{let{onClose:t,wrapperRef:a,reaction:s,onMsgClick:l,anaRef:d}=e,{t:g}=(0,b.$)(),u=(0,n.useContext)(c.Z),[x,f]=(0,n.useState)(""),m=(0,o.I0)(),w=(0,o.v9)(e=>e.play.anaSpectatingGameplay),S=(0,o.v9)(e=>e.play.muteAnaSpectateMessages),I=(0,o.v9)(e=>e.play.anaNotifResponded),j=(0,o.v9)(e=>e.play.isPlayerLoaded),C=!(0,A.nI)(),k=(0,n.useCallback)(e=>{m({type:y.Z.UPDATE_ANA_BOT_STATE,payload:{anaSpectatingGameplay:e}}),(0,r.L9)("ChatBotSpectatePopUpClicked",{chatSessionId:sessionStorage.getItem(p.FdJ)||"",allowed:e}),m({type:y.Z.UPDATE_ANA_BOT_STATE,payload:{anaNotifResponded:!0}})},[m,t]);return(0,n.useEffect)(()=>{f(""),I||(0,r.L9)("ChatBotSpectatePopUpDisplayed",{chatSessionId:sessionStorage.getItem(p.FdJ)||""})},[]),(0,n.useEffect)(()=>{S&&t()},[S]),(0,i.jsx)(ef.Hl,{ref:a,className:"".concat(x,"\n        ").concat(I||w||C&&j?"ana-spectating":""),isMobileMenu:C&&j,refreshBtnVisible:!(0,A.tq)()&&!(0,N.DJ)()&&(u.isAppPage||u.isPlayPage||!1),style:C&&j?{left:68,top:0,width:384,borderRadius:60,transform:"translate(0px, 10px)",maxWidth:"calc(100vw - 86px)"}:{},children:I||w||C&&j?(0,i.jsxs)(ef.i7,{children:[(0,i.jsxs)(ef.zi,{onClick:l,children:[(0,i.jsx)(ef.a5,{className:"messages",children:(0,i.jsx)("img",{src:(0,h.jW)(ey),alt:""})}),(0,i.jsx)(v.gd,{children:I?w?s||g("anaWatchMsg"):g("anaNoSpectate"):g("anaSpectatePrompt")})]}),(0,i.jsx)(ef.a5,{className:"rounded mute",onClick:()=>{m({type:y.Z.UPDATE_ANA_BOT_STATE,payload:{muteAnaSpectateMessages:!0}})},children:(0,i.jsx)("img",{src:(0,h.jW)(B),alt:""})}),C&&j&&!w&&!I&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(ef.Z0,{}),(0,i.jsx)(ef.a5,{className:"rounded yes",onClick:()=>{k(!0)},children:(0,i.jsx)("img",{src:(0,h.jW)(ew),alt:""})})]}),(0,i.jsx)(ef.a5,{className:"rounded ".concat(w||I?"close":"no"),onClick:w||I?t:()=>{k(!1)},children:(0,i.jsx)(E.x,{style:{color:_.qm.colors.white70},size:16})})]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(v.lU,{children:g("anaSpectatePrompt")}),(0,i.jsxs)(ef.pI,{mobileMenu:(0,A.yR)()&&j,children:[(0,i.jsx)(en.z,{size:"small",variant:"defaultOutline",onClick:()=>{k(!1)},children:g("no")}),(0,i.jsx)(en.z,{size:"small",variant:"primary",onClick:()=>{k(!0)},children:g("yes")})]})]})})},eS=a(46004),eI=function(e,t,a,i){return new(a||(a=Promise))(function(n,o){function s(e){try{r(i.next(e))}catch(e){o(e)}}function l(e){try{r(i.throw(e))}catch(e){o(e)}}function r(e){var t;e.done?n(e.value):((t=e.value)instanceof a?t:new a(function(e){e(t)})).then(s,l)}r((i=i.apply(e,t||[])).next())})};let ej="".concat(p.u1t,"/assets/images/ana-icon.webp"),eC="".concat(p.u1t,"/assets/videos/ana-exp.webm");var ek=()=>{let[e,t]=(0,n.useState)(!1),[a,w]=(0,n.useState)(!1),v=(0,o.v9)(e=>e.user.userMsgFromSearch),S=(0,o.v9)(e=>e.user.hideAnaBotChat),I=(0,o.v9)(e=>e.play.anaSpectatingGameplay);(0,o.v9)(e=>e.play.muteAnaSpectateMessages);let j=(0,o.v9)(e=>e.play.isPlayerLoaded),C=(0,o.v9)(e=>e.ads.adsEnded),k=(0,o.v9)(e=>e.auth.showPreloader),P=(0,o.v9)(e=>e.play.isAndroidConnected),B=(0,o.v9)(e=>e.play.anaNotifResponded),E=(0,o.v9)(e=>e.play.showMobileHeaderFooter),{t:_}=(0,b.$)(),[N,Z]=(0,n.useState)(""),R=(0,n.useRef)(null),U=(0,o.I0)(),T=(0,n.useContext)(c.Z),W=T.isHomePage,F=(0,n.useRef)(null),L=(0,n.useRef)(null),H=(0,n.useRef)(!1),Q=(0,n.useRef)(!1),[O,D]=(0,n.useState)(!1),z=(0,n.useRef)(null),J=(0,n.useRef)(null),M=navigator.maxTouchPoints>0?"pointerdown":"pointermove",V=()=>eI(void 0,void 0,void 0,function*(){if(J.current)try{J.current.muted=!0,J.current.hasAttribute("playsinline")||J.current.setAttribute("playsinline","");let e=J.current.play();void 0!==e&&(yield e)}catch(e){(0,d.ZP)(Error("Failed to play ana-exp video"),{error:e})}finally{document.removeEventListener(M,V)}});(0,n.useEffect)(()=>(document.addEventListener(M,V,{once:!0}),()=>{document.removeEventListener(M,V)}),[]),(0,n.useEffect)(()=>{Q.current=e},[e]);let G=(0,n.useCallback)(()=>{var e;let t=document.createElement("canvas"),a=t.getContext("2d"),i=null===(e=s.default.getState().play.videoRef)||void 0===e?void 0:e.current,n=s.default.getState().play.orientation,o=s.default.getState().play.isPlayerLoaded;return i&&o?(n===f.cj.landscape?(0,A.tq)()?(t.width=i.clientHeight,t.height=i.clientWidth,null==a||a.rotate(-Math.PI/2),null==a||a.drawImage(i,-t.width/2,0,t.height,t.width)):(t.width=i.clientHeight,t.height=i.clientWidth,null==a||a.translate(t.width/2,t.height/2),null==a||a.rotate(-Math.PI/2),null==a||a.drawImage(i,-t.height/2,-t.width/2,t.height,t.width)):(t.width=i.clientWidth,t.height=i.clientHeight,null==a||a.drawImage(i,0,0,i.clientWidth,i.clientHeight)),t.toDataURL("image/jpeg").split(";base64,")[1]):""},[s.default.getState().play.videoRef,s.default.getState().play.orientation,s.default.getState().play.isPlayerLoaded]),q=()=>eI(void 0,void 0,void 0,function*(){var e;let t={status:f.VL.Failure,botSessionData:{}},a={uaId:(0,A.Fz)(p.nPo),uaSessionId:(0,A.io)(p.K3T)};(t=yield m.ZP.startAiChatSession({},a)).status===f.VL.Success&&sessionStorage.setItem(p.FdJ,null===(e=t.botSessionData)||void 0===e?void 0:e.chatSessionId)}),Y=e=>eI(void 0,void 0,void 0,function*(){let t=new URLSearchParams;t.append("text_input",e),t.append("text_filtering","standard"),t.append("character_voice_gen","female_03.wav"),t.append("language","en"),t.append("output_file_name","output_audio"),t.append("output_file_timestamp","true");let a=yield fetch("https://audio.testngg.net/api/tts-generate",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:t}),i=yield a.json();z.current&&i.output_file_url&&(z.current.src="https://audio.testngg.net".concat(i.output_file_url))}),K=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return eI(void 0,void 0,void 0,function*(){var a,i,n;let o=G();if(!o&&!e||!document.hasFocus)return;sessionStorage.getItem(p.FdJ)||(yield q());let l={uaId:(0,A.Fz)(p.nPo),uaSessionId:(0,A.io)(p.K3T),appId:T.appInfo.appId,chatSessionId:sessionStorage.getItem(p.FdJ)||"",feDeviceType:(0,A.zj)().feDeviceType,element:"gamePlay",base64Image:o||"FirstCall",packageName:T.appInfo.packageName,gameName:T.appInfo.appName,playSessionId:T.playSessionId||"NA",feSessionId:window.feSessionId||"",ntmSource:sessionStorage.getItem("ntmSource")||"NA",isFirstCall:e};(0,A.c6)()&&s.default.getState().play.robloxExperienceId.toString()&&(l=Object.assign(Object.assign({},l),{robloxExperienceId:s.default.getState().play.robloxExperienceId.toString()}));let r=yield m.ZP.analyzeBotScreenshot({},l);if(r.status===f.VL.Success&&(null===(a=r.botResponse)||void 0===a?void 0:a.answer)){let e=[...s.default.getState().play.chatHistory,{type:"ai",data:{additional_kwargs:{cta:JSON.stringify(r.botResponse.ctaList),gifUrl:r.botResponse.gifUrl},tool_calls:[],response_metadata:{},invalid_tool_calls:[],content:r.botResponse.answer}}];U({type:y.Z.SET_CHAT_HISTORY,payload:{chatHistory:e}}),Z(null===(i=r.botResponse)||void 0===i?void 0:i.answer),s.default.getState().play.muteAnaSpectateMessages||!s.default.getState().play.anaSpectatingGameplay||Q.current||(w(!0),t(!1),D(!1),yield Y(null===(n=r.botResponse)||void 0===n?void 0:n.answer))}})};(0,n.useEffect)(()=>{I&&setTimeout(()=>eI(void 0,void 0,void 0,function*(){yield K(!0),setInterval(()=>eI(void 0,void 0,void 0,function*(){yield K(!1)}),1e3*(T.appInfo.playFeFeatures.aiBotScreenshotFrequencySecs||60))}),2e4)},[I]);let X=(0,n.useCallback)(a=>{(!s.default.getState().play.anaSpectatingGameplay||e)&&F.current&&!F.current.contains(a.target)&&L.current&&!L.current.contains(a.target)&&(t(!1),D(!1))},[s.default.getState().play.anaSpectatingGameplay,e]);(0,n.useEffect)(()=>(e&&document.addEventListener("mousedown",X),()=>{document.removeEventListener("mousedown",X)}),[e]),(0,n.useEffect)(()=>{let a=()=>{e||H.current||(t(!0),H.current=!0)};return T.isHomePage&&((0,A.yR)()?window.addEventListener("scroll",a,!0):setTimeout(()=>{t(!0)},2e3)),W||U({type:l.Z.SHOW_ANA_BOT,payload:{showAnaBot:!0}}),()=>{window.removeEventListener("scroll",a,!0)}},[]),(0,n.useEffect)(()=>{!(!j||(0,A.tq)())&&C&&!k&&P&&T.appInfo.playFeFeatures.enableAiScreenshot&&(w(!0),t(!1),D(!1))},[j,C,k,P]);let $=(0,n.useCallback)(()=>{t(e=>!e),w(!1)},[t]);(0,n.useEffect)(()=>{v&&$()},[v]);let ee=(0,n.useCallback)(()=>{(0,r.L9)("ChatBotClosed",{chatSessionId:sessionStorage.getItem(p.FdJ)||""}),t(!1),w(!1),D(!1),U({type:l.Z.SHOW_ANA_BOT,payload:{showAnaBot:!0}})},[U,t,w,D,r.L9]),et=(0,n.useCallback)(()=>{t(!1),w(!1),D(!0),t(!0)},[t,w,D]);return(0,i.jsxs)(eS.ZP,{className:"".concat(S?"hide ":"").concat(W?"home":""),id:"anahandler",bg:(0,h.jW)(g),ref:R,mobileMenu:!(0,A.nI)()&&j,children:[(0,i.jsx)("audio",{id:"sound",controls:!0,autoPlay:!0,ref:z}),!E&&(0,i.jsxs)(eS.G7,{id:"collapse-ana",ref:L,onClick:$,mobileMenu:!(0,A.nI)()&&j,children:[(0,i.jsx)("video",{ref:J,poster:ej,preload:"auto",muted:!0,loop:!0,playsInline:!0,src:eC,className:"ana-exp"}),!(0,A.nI)()&&j&&!e&&!a&&!I&&!B&&T.appInfo.playFeFeatures.enableAiScreenshot&&(0,i.jsx)("img",{src:(0,h.jW)(u),alt:"",className:"ana-bell",onClick:e=>{e.stopPropagation(),w(!0)}})]}),(0,i.jsxs)(i.Fragment,{children:[e&&!a&&((0,A.nI)()?(0,i.jsx)(eb,{wrapperRef:F,onClose:ee,startSessionOnRender:O,reaction:N}):(0,x.createPortal)((0,i.jsx)(eb,{wrapperRef:F,onClose:ee,startSessionOnRender:O,reaction:N}),document.body)),a&&(0,i.jsx)(ev,{wrapperRef:F,anaRef:R,onClose:ee,reaction:N,onMsgClick:et})]})]})}}}]);
//# sourceMappingURL=1034.900a5ee3127be798.js.map